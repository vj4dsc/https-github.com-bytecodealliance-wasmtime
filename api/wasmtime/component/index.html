<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="Embedding API for the Component Model"><title>wasmtime::component - Rust</title><script> if (window.location.protocol !== "file:") document.write(`<link rel="preload" as="font" type="font/woff2" crossorigin href="../../static.files/SourceSerif4-Regular-46f98efaafac5295.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../static.files/FiraSans-Regular-018c141bf0843ffd.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../static.files/FiraSans-Medium-8f9a781e4970d388.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../static.files/SourceCodePro-Regular-562dcc5011b6de7d.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../static.files/SourceCodePro-Semibold-d899c5a5c4aeb14a.ttf.woff2">`)</script><link rel="stylesheet" href="../../static.files/normalize-76eba96aa4d2e634.css"><link rel="stylesheet" href="../../static.files/rustdoc-e935ef01ae1c1829.css"><meta name="rustdoc-vars" data-root-path="../../" data-static-root-path="../../static.files/" data-current-crate="wasmtime" data-themes="" data-resource-suffix="" data-rustdoc-version="1.79.0-nightly (1388d7a06 2024-03-20)" data-channel="nightly" data-search-js="search-42d8da7a6b9792c2.js" data-settings-js="settings-4313503d2e1961c2.js" ><script src="../../static.files/storage-4c98445ec4002617.js"></script><script defer src="../sidebar-items.js"></script><script defer src="../../static.files/main-12cf3b4f4f9dc36d.js"></script><noscript><link rel="stylesheet" href="../../static.files/noscript-04d5337699b92874.css"></noscript><link rel="alternate icon" type="image/png" href="../../static.files/favicon-16x16-8b506e7a72182f1c.png"><link rel="alternate icon" type="image/png" href="../../static.files/favicon-32x32-422f7d1d52889060.png"><link rel="icon" type="image/svg+xml" href="../../static.files/favicon-2c020d218678b618.svg"></head><body class="rustdoc mod"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="mobile-topbar"><button class="sidebar-menu-toggle" title="show sidebar"></button></nav><nav class="sidebar"><div class="sidebar-crate"><h2><a href="../../wasmtime/index.html">wasmtime</a><span class="version">21.0.0</span></h2></div><h2 class="location"><a href="#">Module component</a></h2><div class="sidebar-elems"><section><ul class="block"><li><a href="#modules">Modules</a></li><li><a href="#macros">Macros</a></li><li><a href="#structs">Structs</a></li><li><a href="#enums">Enums</a></li><li><a href="#traits">Traits</a></li><li><a href="#derives">Derive Macros</a></li></ul></section><h2><a href="../index.html">In crate wasmtime</a></h2></div></nav><div class="sidebar-resizer"></div>
    <main><div class="width-limiter"><nav class="sub"><form class="search-form"><span></span><div id="sidebar-button" tabindex="-1"><a href="../../wasmtime/all.html" title="show sidebar"></a></div><input class="search-input" name="search" aria-label="Run search in the documentation" autocomplete="off" spellcheck="false" placeholder="Click or press ‘S’ to search, ‘?’ for more options…" type="search"><div id="help-button" tabindex="-1"><a href="../../help.html" title="help">?</a></div><div id="settings-menu" tabindex="-1"><a href="../../settings.html" title="settings"><img width="22" height="22" alt="Change settings" src="../../static.files/wheel-7b819b6101059cd0.svg"></a></div></form></nav><section id="main-content" class="content"><div class="main-heading"><h1>Module <a href="../index.html">wasmtime</a>::<wbr><a class="mod" href="#">component</a><button id="copy-path" title="Copy item path to clipboard"><img src="../../static.files/clipboard-7571035ce49a181d.svg" width="19" height="18" alt="Copy item path"></button></h1><span class="out-of-band"><a class="src" href="../../src/wasmtime/runtime/component/mod.rs.html#1-772">source</a> · <button id="toggle-all-docs" title="collapse all docs">[<span>&#x2212;</span>]</button></span></div><span class="item-info"><div class="stab portability">Available on <strong>crate features <code>runtime</code> and <code>component-model</code></strong> only.</div></span><details class="toggle top-doc" open><summary class="hideme"><span>Expand description</span></summary><div class="docblock"><h2 id="embedding-api-for-the-component-model"><a class="doc-anchor" href="#embedding-api-for-the-component-model">§</a>Embedding API for the Component Model</h2>
<p>This module contains the embedding API for the <a href="https://component-model.bytecodealliance.org">Component Model</a> in
Wasmtime. This module requires the <code>component-model</code> feature to be enabled,
which is enabled by default. The embedding API here is mirrored after the
core wasm embedding API at the crate root and is intended to have the same
look-and-feel while handling concepts of the component model.</p>
<p>The component model is a broad topic which can’t be explained here fully, so
it’s recommended to read over individual items’ documentation to see more
about the capabilities of the embedding API. At a high-level, however,
perhaps the most interesting items in this module are:</p>
<ul>
<li>
<p><a href="struct.Component.html" title="struct wasmtime::component::Component"><code>Component</code></a> - a compiled component ready to be instantiated. Similar to
a <a href="../struct.Module.html" title="struct wasmtime::Module"><code>Module</code></a> for core wasm.</p>
</li>
<li>
<p><a href="struct.Linker.html" title="struct wasmtime::component::Linker"><code>Linker</code></a> - a component-style location for defining host functions. This
is not the same as <a href="../struct.Linker.html" title="struct wasmtime::Linker"><code>wasmtime::Linker</code></a> for core wasm
modules.</p>
</li>
<li>
<p><a href="macro.bindgen.html" title="macro wasmtime::component::bindgen"><code>bindgen!</code></a> - a macro to generate Rust bindings for a <a href="https://component-model.bytecodealliance.org/design/wit.html">WIT</a> <a href="https://component-model.bytecodealliance.org/design/worlds.html">world</a>. This
maps all WIT types into Rust automatically and generates traits for
embedders to implement.</p>
</li>
</ul>
<p>Embedders of the component model will typically start by defining their API
in <a href="https://component-model.bytecodealliance.org/design/wit.html">WIT</a>. This describes what will be available to guests and what needs to
be provided to the embedder by the guest. This <a href="https://component-model.bytecodealliance.org/design/worlds.html"><code>world</code></a> that was
created is then fed into <a href="macro.bindgen.html" title="macro wasmtime::component::bindgen"><code>bindgen!</code></a> to generate types and traits for the
embedder to use. The embedder then implements these traits, adds
functionality via the generated <code>add_to_linker</code> method (see <a href="macro.bindgen.html" title="macro wasmtime::component::bindgen"><code>bindgen!</code></a> for
more info), and then instantiates/executes a component.</p>
<p>It’s recommended to read over the <a href="https://component-model.bytecodealliance.org">documentation for the Component
Model</a> to get an overview about how to build components
from various languages.</p>
<h3 id="example-usage"><a class="doc-anchor" href="#example-usage">§</a>Example Usage</h3>
<p>Imagine you have the following WIT package definition in a file called world.wit
along with a component (my_component.wasm) that targets <code>my-world</code>:</p>
<div class="example-wrap"><pre class="language-text"><code>package component:my-package;

world my-world {
    import name: func() -&gt; string;
    export greet: func() -&gt; string;
}
</code></pre></div>
<p>You can instantiate and call the component like so:</p>

<div class="example-wrap"><pre class="rust rust-example-rendered"><code><span class="kw">fn </span>main() -&gt; wasmtime::Result&lt;()&gt; {
    <span class="comment">// Instantiate the engine and store
    </span><span class="kw">let </span>engine = wasmtime::Engine::default();
    <span class="kw">let </span><span class="kw-2">mut </span>store = wasmtime::Store::new(<span class="kw-2">&amp;</span>engine, ());

    <span class="comment">// Load the component from disk
    </span><span class="kw">let </span>bytes = std::fs::read(<span class="string">"my_component.wasm"</span>)<span class="question-mark">?</span>;
    <span class="kw">let </span>component = wasmtime::component::Component::new(<span class="kw-2">&amp;</span>engine, bytes)<span class="question-mark">?</span>;

    <span class="comment">// Configure the linker
    </span><span class="kw">let </span><span class="kw-2">mut </span>linker = wasmtime::component::Linker::new(<span class="kw-2">&amp;</span>engine);
    <span class="comment">// The component expects one import `name` that
    // takes no params and returns a string
    </span>linker
        .root()
        .func_wrap(<span class="string">"name"</span>, |_store, _params: ()| {
            <span class="prelude-val">Ok</span>((String::from(<span class="string">"Alice"</span>),))
        })<span class="question-mark">?</span>;

    <span class="comment">// Instantiate the component
    </span><span class="kw">let </span>instance = linker.instantiate(<span class="kw-2">&amp;mut </span>store, <span class="kw-2">&amp;</span>component)<span class="question-mark">?</span>;

    <span class="comment">// Call the `greet` function
    </span><span class="kw">let </span>func = instance.get_func(<span class="kw-2">&amp;mut </span>store, <span class="string">"greet"</span>).expect(<span class="string">"greet export not found"</span>);
    <span class="kw">let </span><span class="kw-2">mut </span>result = [wasmtime::component::Val::String(<span class="string">""</span>.into())];
    func.call(<span class="kw-2">&amp;mut </span>store, <span class="kw-2">&amp;</span>[], <span class="kw-2">&amp;mut </span>result)<span class="question-mark">?</span>;

    <span class="comment">// This should print out `Greeting: [String("Hello, Alice!")]`
    </span><span class="macro">println!</span>(<span class="string">"Greeting: {:?}"</span>, result);

    <span class="prelude-val">Ok</span>(())
}</code></pre></div>
<p>Manually configuring the linker and calling untyped component exports is
a bit tedious and error prone. The <a href="macro.bindgen.html" title="macro wasmtime::component::bindgen"><code>bindgen!</code></a> macro can be used to
generate bindings eliminating much of this boilerplate.</p>
<p>See the docs for <a href="macro.bindgen.html" title="macro wasmtime::component::bindgen"><code>bindgen!</code></a> for more information on how to use it.</p>
</div></details><h2 id="modules" class="section-header">Modules<a href="#modules" class="anchor">§</a></h2><ul class="item-table"><li><div class="item-name"><a class="mod" href="types/index.html" title="mod wasmtime::component::types">types</a></div><div class="desc docblock-short">This module defines the <code>Type</code> type, representing the dynamic form of a component interface type.</div></li></ul><h2 id="macros" class="section-header">Macros<a href="#macros" class="anchor">§</a></h2><ul class="item-table"><li><div class="item-name"><a class="macro" href="macro.bindgen.html" title="macro wasmtime::component::bindgen">bindgen</a></div><div class="desc docblock-short">Generate bindings for a <a href="https://component-model.bytecodealliance.org/design/worlds.html">WIT world</a>.</div></li><li><div class="item-name"><a class="macro" href="macro.flags.html" title="macro wasmtime::component::flags">flags</a></div><div class="desc docblock-short">A macro to generate a Rust type corresponding to WIT <code>flags</code></div></li></ul><h2 id="structs" class="section-header">Structs<a href="#structs" class="anchor">§</a></h2><ul class="item-table"><li><div class="item-name"><a class="struct" href="struct.Component.html" title="struct wasmtime::component::Component">Component</a></div><div class="desc docblock-short">A compiled WebAssembly Component.</div></li><li><div class="item-name"><a class="struct" href="struct.ExportInstance.html" title="struct wasmtime::component::ExportInstance">ExportInstance</a></div><div class="desc docblock-short">Description of the exports of a single instance.</div></li><li><div class="item-name"><a class="struct" href="struct.Exports.html" title="struct wasmtime::component::Exports">Exports</a></div><div class="desc docblock-short">Description of the exports of an <a href="struct.Instance.html" title="struct wasmtime::component::Instance"><code>Instance</code></a>.</div></li><li><div class="item-name"><a class="struct" href="struct.Func.html" title="struct wasmtime::component::Func">Func</a></div><div class="desc docblock-short">A WebAssembly component function which can be called.</div></li><li><div class="item-name"><a class="struct" href="struct.Instance.html" title="struct wasmtime::component::Instance">Instance</a></div><div class="desc docblock-short">An instantiated component.</div></li><li><div class="item-name"><a class="struct" href="struct.InstancePre.html" title="struct wasmtime::component::InstancePre">InstancePre</a></div><div class="desc docblock-short">A “pre-instantiated” <a href="struct.Instance.html" title="struct wasmtime::component::Instance"><code>Instance</code></a> which has all of its arguments already
supplied and is ready to instantiate.</div></li><li><div class="item-name"><a class="struct" href="struct.Linker.html" title="struct wasmtime::component::Linker">Linker</a></div><div class="desc docblock-short">A type used to instantiate <a href="struct.Component.html" title="struct wasmtime::component::Component"><code>Component</code></a>s.</div></li><li><div class="item-name"><a class="struct" href="struct.LinkerInstance.html" title="struct wasmtime::component::LinkerInstance">LinkerInstance</a></div><div class="desc docblock-short">Structure representing an “instance” being defined within a linker.</div></li><li><div class="item-name"><a class="struct" href="struct.Resource.html" title="struct wasmtime::component::Resource">Resource</a></div><div class="desc docblock-short">A host-defined resource in the component model.</div></li><li><div class="item-name"><a class="struct" href="struct.ResourceAny.html" title="struct wasmtime::component::ResourceAny">ResourceAny</a></div><div class="desc docblock-short">Representation of a resource in the component model, either a guest-defined
or a host-defined resource.</div></li><li><div class="item-name"><a class="struct" href="struct.ResourceTable.html" title="struct wasmtime::component::ResourceTable">ResourceTable</a></div><div class="desc docblock-short">The <code>ResourceTable</code> type maps a <code>Resource&lt;T&gt;</code> to its <code>T</code>.</div></li><li><div class="item-name"><a class="struct" href="struct.ResourceType.html" title="struct wasmtime::component::ResourceType">ResourceType</a></div><div class="desc docblock-short">Representation of a resource type in the component model.</div></li><li><div class="item-name"><a class="struct" href="struct.TypedFunc.html" title="struct wasmtime::component::TypedFunc">TypedFunc</a></div><div class="desc docblock-short">A statically-typed version of <a href="struct.Func.html" title="struct wasmtime::component::Func"><code>Func</code></a> which takes <code>Params</code> as input and
returns <code>Return</code>.</div></li><li><div class="item-name"><a class="struct" href="struct.WasmList.html" title="struct wasmtime::component::WasmList">WasmList</a></div><div class="desc docblock-short">Representation of a list of values that are owned by a WebAssembly instance.</div></li><li><div class="item-name"><a class="struct" href="struct.WasmStr.html" title="struct wasmtime::component::WasmStr">WasmStr</a></div><div class="desc docblock-short">Representation of a string located in linear memory in a WebAssembly
instance.</div></li></ul><h2 id="enums" class="section-header">Enums<a href="#enums" class="anchor">§</a></h2><ul class="item-table"><li><div class="item-name"><a class="enum" href="enum.ResourceTableError.html" title="enum wasmtime::component::ResourceTableError">ResourceTableError</a></div><div class="desc docblock-short">Errors returned by operations on <code>ResourceTable</code></div></li><li><div class="item-name"><a class="enum" href="enum.Type.html" title="enum wasmtime::component::Type">Type</a></div><div class="desc docblock-short">Represents a component model interface type</div></li><li><div class="item-name"><a class="enum" href="enum.Val.html" title="enum wasmtime::component::Val">Val</a></div><div class="desc docblock-short">Represents possible runtime values which a component function can either
consume or produce</div></li></ul><h2 id="traits" class="section-header">Traits<a href="#traits" class="anchor">§</a></h2><ul class="item-table"><li><div class="item-name"><a class="trait" href="trait.ComponentNamedList.html" title="trait wasmtime::component::ComponentNamedList">ComponentNamedList</a></div><div class="desc docblock-short">A trait representing a static list of named types that can be passed to or
returned from a <a href="struct.TypedFunc.html" title="struct wasmtime::component::TypedFunc"><code>TypedFunc</code></a>.</div></li><li><div class="item-name"><a class="trait" href="trait.ComponentType.html" title="trait wasmtime::component::ComponentType">ComponentType</a></div><div class="desc docblock-short">A trait representing types which can be passed to and read from components
with the canonical ABI.</div></li><li><div class="item-name"><a class="trait" href="trait.Lift.html" title="trait wasmtime::component::Lift">Lift</a></div><div class="desc docblock-short">Host types which can be created from the canonical ABI.</div></li><li><div class="item-name"><a class="trait" href="trait.Lower.html" title="trait wasmtime::component::Lower">Lower</a></div><div class="desc docblock-short">Host types which can be passed to WebAssembly components.</div></li></ul><h2 id="derives" class="section-header">Derive Macros<a href="#derives" class="anchor">§</a></h2><ul class="item-table"><li><div class="item-name"><a class="derive" href="derive.ComponentType.html" title="derive wasmtime::component::ComponentType">ComponentType</a></div><div class="desc docblock-short">Derive macro to generate implementations of the <a href="trait.ComponentType.html" title="trait wasmtime::component::ComponentType"><code>ComponentType</code></a> trait.</div></li><li><div class="item-name"><a class="derive" href="derive.Lift.html" title="derive wasmtime::component::Lift">Lift</a></div><div class="desc docblock-short">A derive macro for generating implementations of the <a href="trait.Lift.html" title="trait wasmtime::component::Lift"><code>Lift</code></a> trait.</div></li><li><div class="item-name"><a class="derive" href="derive.Lower.html" title="derive wasmtime::component::Lower">Lower</a></div><div class="desc docblock-short">A derive macro for generating implementations of the <a href="trait.Lower.html" title="trait wasmtime::component::Lower"><code>Lower</code></a> trait.</div></li></ul></section></div></main></body></html>